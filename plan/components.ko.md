---
layout: default
title: 컴포넌트 설계
lang: ko
---

# 컴포넌트 설계

사용자가 상호작용할 수 있는 UI 컴포넌트를 계획하고 설계합니다.

## 컴포넌트가 중요한 이유

UI 컴포넌트는 커넥터의 사용자에게 보이는 절반입니다. 사용자가 인라인으로 데이터를 보거나 편집하고, 필요할 때 전체 화면으로 전환하며, 입력된 프롬프트와 UI 액션 간의 컨텍스트를 동기화된 상태로 유지할 수 있게 해줍니다. 초기에 컴포넌트를 계획하면 MCP 서버가 처음부터 올바른 구조화된 데이터와 컴포넌트 메타데이터를 반환하도록 보장할 수 있습니다.

## 사용자 상호작용 명확히 하기

각 사용 사례에 대해 사용자가 보고 조작해야 하는 것을 결정하세요:

- **뷰어 vs. 에디터** - 컴포넌트가 읽기 전용(차트, 대시보드)인지, 아니면 편집 및 쓰기 기능을 지원해야 하는지(폼, 칸반 보드)?
- **단일 실행 vs. 멀티턴** - 사용자가 한 번의 호출로 작업을 완료할 것인지, 아니면 반복하면서 상태가 여러 턴에 걸쳐 유지되어야 하는지?
- **인라인 vs. 전체 화면** - 일부 작업은 기본 인라인 카드에서 편안하지만, 다른 작업은 전체 화면이나 PIP(picture-in-picture) 모드의 이점을 얻습니다. 구현하기 전에 이러한 상태를 스케치하세요.

필요한 필드, 어포던스, 빈 상태를 기록하여 디자인 파트너 및 리뷰어와 검증할 수 있도록 하세요.

## 데이터 요구사항 매핑

컴포넌트는 필요한 모든 것을 툴 응답에서 받아야 합니다. 계획할 때:

- **구조화된 콘텐츠** - 컴포넌트가 파싱할 JSON 페이로드를 정의합니다.
- **초기 컴포넌트 상태** - 초기 렌더링 데이터로 `window.openai.toolOutput`을 사용합니다. `callTool`을 호출하는 후속 팔로업에서는 `callTool`의 반환 값을 사용합니다. 재렌더링을 위해 상태를 캐시하려면 `window.openai.setWidgetState`를 사용할 수 있습니다.
- **인증 컨텍스트** - 컴포넌트가 연결된 계정 정보를 표시해야 하는지, 아니면 모델이 먼저 사용자에게 연결하도록 프롬프트해야 하는지 기록합니다.

이 데이터를 MCP 응답을 통해 제공하는 것이 나중에 임시 API를 추가하는 것보다 간단합니다.

## 반응형 레이아웃 설계

컴포넌트는 데스크톱과 모바일 모두에서 iframe 내부에서 실행됩니다. 다음을 계획하세요:

- **적응형 브레이크포인트** - 최대 너비를 설정하고 작은 화면에서 우아하게 축소되는 레이아웃을 설계합니다.
- **접근 가능한 색상 및 모션** - 시스템 다크 모드를 존중하고(color-scheme 매칭) 키보드 내비게이션을 위한 포커스 상태를 제공합니다.
- **런처 전환** - 사용자가 런처에서 컴포넌트를 열거나 전체 화면으로 확장할 때 내비게이션 요소가 계속 표시되도록 합니다.

컴포넌트 전체에서 일관성을 유지하도록 CSS 변수, 폰트 스택, 아이콘그래피를 미리 문서화하세요.

## 상태 계약 정의

컴포넌트와 채팅 화면이 대화 상태를 공유하기 때문에 무엇이 어디에 저장되는지 명확히 하세요:

- **컴포넌트 상태** - 호스트가 기억해야 하는 상태(선택된 레코드, 스크롤 위치, 스테이징된 폼 데이터)를 유지하려면 `window.openai.setWidgetState` API를 사용합니다.
- **서버 상태** - 백엔드 또는 내장 스토리지 레이어에 권위 있는 데이터를 저장합니다. 후속 툴 호출 후 서버 변경 사항을 컴포넌트 상태로 다시 병합하는 방법을 결정합니다.
- **모델 메시지** - 컴포넌트가 `sendFollowupTurn`을 통해 다시 보내야 하는 사람이 읽을 수 있는 업데이트를 생각하여 대화 기록이 의미 있게 유지되도록 합니다.

이 상태 다이어그램을 조기에 캡처하면 나중에 디버깅하기 어려운 동기화 문제를 방지할 수 있습니다.

## 원격 측정 및 디버깅 훅 계획

인라인 경험은 계측 없이 디버깅하기가 가장 어렵습니다. 다음을 미리 결정하세요:

- 컴포넌트 로드, 버튼 클릭, 유효성 검사 오류에 대한 분석 이벤트를 발생시킵니다.
- 문제를 종단 간 추적할 수 있도록 컴포넌트 원격 측정과 함께 툴 호출 ID를 로깅합니다.
- 컴포넌트가 로드되지 않을 때 대체 방안을 제공합니다(예: 구조화된 JSON을 표시하고 사용자에게 재시도하도록 프롬프트).

이러한 계획이 마련되면 [사용자 정의 UX 구축](../build/custom-ux.md)의 구현 세부 사항으로 넘어갈 준비가 된 것입니다.
